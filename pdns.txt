===== FORWARD ZONE =====

insert into domains (name, type) values ('syawal-idnacademy.id', 'NATIVE');

INSERT INTO records (domain_id, name, content, type,ttl,prio) VALUES (1,'syawal-idnacademy.id','syawal-idnacademy.id admin.syawal-idnacademy.id 1 10380 3600 604800 3600','SOA',86400,NULL);

INSERT INTO records (domain_id, name, content, type,ttl,prio) VALUES (1,'syawal-idnacademy.id','ns1.syawal-idnacademy.id','NS',86400,NULL);

INSERT INTO records (domain_id, name, content, type,ttl,prio) VALUES (1,'ns1.syawal-idnacademy.id','10.23.1.239','A',120,NULL);

INSERT INTO records (domain_id, name, content, type,ttl,prio) VALUES (1,'ns2.syawal-idnacademy.id','10.23.1.240','A',120,NULL);


====== REVERSE ZONE =====


INSERT INTO records (domain_id, name, content, type,ttl,prio) VALUES (2,'1.23.10.in-addr.arpa','syawal-idnacademy.id admin.syawal-idnacademy.id 1 10380 3600 604800 3600','SOA',86400,NULL);

INSERT INTO records (domain_id, name, content, type,ttl,prio) VALUES (2,'1.23.10.in-addr.arpa','ns1.syawal-idnacademy.id','NS',120,NULL);

INSERT INTO records (domain_id, name, content, type,ttl,prio) VALUES (2,'239.1.23.10.in-addr.arpa','ns1.syawal-idnacademy.id','PTR',120,NULL);

INSERT INTO records (domain_id, name, content, type,ttl,prio) VALUES (2,'240.1.23.10.in-addr.arpa','ns2.syawal-idnacademy.id','PTR',120,NULL);

==== REVERSE POWERDNS ====

insert into pdns.supermasters values ('10.23.1.215', 'ns2.syawal-idnacademy.id', 'admin');


====== INSTALL & CONFIG POWERDNS ======

sudo apt update && sudo apt upgrade 
sudo apt install mariadb-server mariadb-client -y

sudo mysql

create database pdns;
grant all privileges on pdns.* TO 'pdns'@'localhost' identified by 'admin123';
flush privileges;

exit

sudo su

sudo systemctl stop systemd-resolved
sudo systemctl disable systemd-resolved
sudo rm -rf /etc/resolv.conf
echo "nameserver 8.8.8.8" | sudo tee /etc/resolv.conf

sudo apt-get install pdns-server pdns-backend-mysql -y

sudo mysql -u pdns -p pdns < /usr/share/pdns-backend-mysql/schema/schema.mysql.sql
sudo nano /etc/powerdns/pdns.d/pdns.local.gmysql.conf

file
# MySQL Configuration
#
# Launch gmysql backend
launch+=gmysql
# gmysql parameters
gmysql-host=127.0.0.1
gmysql-port=3306
gmysql-dbname=pdns
gmysql-user=pdns
gmysql-password=admin123
gmysql-dnssec=yes
# gmysql-socket=

sudo chown pdns: /etc/powerdns/pdns.d/pdns.local.gmysql.conf
sudo chmod 666 /etc/powerdns/pdns.d/pdns.local.gmysql.conf

sudo systemctl stop pdns.service
sudo pdns_server --daemon=no --guardian=no --loglevel=9
systemctl start pdns
systemctl restart pdns

ss -alnp4 | grep pdns
check if powerdns is responding to requests
dig @127.0.0.1



